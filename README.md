ダーツゲーム — Single HTML SPA

シンプルな**単一HTMLファイル**だけで動く、キャンバス描画のダーツ・ミニゲームです。クリックでスロー、スコアは自動計算。**練習／301／501**に対応し、洗練されたモダンUIで学習と遊びを両立します。

> **対象**: 中学生以上・初学者OK / VS Code 推奨
> **依存**: なし（ビルド・パッケージ不要）
> **ファイル**: `darts-game.html`（1ファイルのみ）

---

## 目次

* [TL;DR](#tldr)
* [デモ（ローカルで開く）](#デモローカルで開く)
* [機能](#機能)
* [ルール（超やさしい説明）](#ルール超やさしい説明)
* [クイックスタート（VS Code）](#クイックスタートvs-code)
* [仕組みの概要](#仕組みの概要)
* [コード構成](#コード構成)
* [カスタマイズ](#カスタマイズ)
* [キーボード&操作](#キーボード操作)
* [よくある質問（FAQ）](#よくある質問faq)
* [トラブルシュート](#トラブルシュート)
* [アクセシビリティ](#アクセシビリティ)
* [パフォーマンス](#パフォーマンス)
* [開発メモ](#開発メモ)
* [ロードマップ](#ロードマップ)
* [貢献ガイドライン](#貢献ガイドライン)
* [ライセンス](#ライセンス)
* [変更履歴](#変更履歴)
* [（中学生向け）ミニ解説](#中学生向けミニ解説)
* [SNS用コピペ文](#sns用コピペ文)

---

## TL;DR

1. `darts-game.html` を保存してブラウザで開く。
2. ボードを**クリック**して3投 → **次のターン**。
3. **モード**を「練習／301／501」から選ぶ。
4. 迷ったら **Z:一手戻す** / **R:リセット**。

---

## デモ（ローカルで開く）

* 方法A: `darts-game.html` をダブルクリックして既定のブラウザで開く。
* 方法B: VS Code 拡張 **Live Server** を使うと自動リロードで快適。

> 💡 ネットワーク接続がなくても動作します（フォントは回線無しだと既定フォントにフォールバック）。

---

## 機能

* **本格ボード**: 20セクター、ダブル／トリプル、アウターブル（25）／インナーブル（50）
* **クリックでスロー** & 自動スコア計算
* **モード**: 練習（合計のみ）／301／501
* **3本で1ターン**: ターン得点と履歴テーブルを表示
* **Undo/Reset**: 一手戻す（Z）／リセット（R）
* **シンプルルール**: 残りがマイナスになる投擲は0点扱い
* **モダンUI**: グラス風カード、KPIパネル、レスポンシブ対応

---

## ルール（超やさしい説明）

* 真ん中の赤は **50点**（インナーブル）。その周りの緑は **25点**（アウターブル）。
* 細い輪っかの **トリプル**は点数×3、外周の **ダブル**は点数×2。
* 301/501 モードでは、**残り点を0にする**のが目標。マイナスになる投げは **0点**として扱います。

---

## クイックスタート（VS Code）

1. **新規ファイル**を作成 → キャンバスのコードを**まるごとコピペ**。
2. ファイル名を `darts-game.html` で保存。
3. **開く**: そのままダブルクリック / VS Code の **Go Live**。
4. **遊ぶ**: モード選択 → ボードをクリック → 3投で1ターン。

> 参考: Live Server がない場合は、Chrome/Edge/Safari/Firefox いずれでもOK。

---

## 仕組みの概要

* **キャンバス描画**: 複数の同心円や扇形を重ね、ボードを表現。
* **位置判定**: クリック座標から中心までの**距離**と**角度**を計算し、

  * 距離 → シングル／ダブル／トリプル／ブルの **リング** を判定。
  * 角度 → 18°ごとの区切りで **セクター番号（20,1,18,…）** を決定。
* **スコア計算**: `基本点 × 倍率`（例: T20 → 20×3=60）。
* **ゲーム管理**: 状態（残り点・ターン・履歴）を1ファイル内のJSで完結管理。

---

## コード構成

> すべて `darts-game.html` に含まれます（HTML/CSS/JS の3部構成）

* **HTML**: レイアウト（ヘッダ、ボード、操作、履歴）。
* **CSS**: グラデ背景・ガラスカード・KPI・レスポンシブ。
* **JS**:

  * `SECTORS` … セクター順（上=20から時計回り）
  * `RATIOS` … 実寸ボード比率に基づくリング半径比
  * `drawBoard()` … ボードの描画
  * `scoreAt(x,y)` … クリック地点のスコア判定
  * `setMode(mode)` … 練習/301/501 の初期化
  * `addThrow()` / `endTurn()` / `undo()` … 投擲・ターン管理
  * `updateUI()` … KPIや履歴の更新

---

## カスタマイズ

**色**

* CSS 冒頭の変数（例: `--green`, `--red`, `--single-dark`）を変更。

**サイズ**

* `BOARD_R`（ボード半径）や `canvas` の CSS サイズを変更。

**モード**

* `setMode()` を拡張して 701/クリケット等の追加を検討可能。

**厳密ルール（例: バースト）**

* 現仕様は「マイナス投擲は0点加算なし」。ターン無効（いわゆるバースト）に変える場合は、

  * `addThrow()` でマイナス判定時に **ターン全体を無効化** → `endTurn()` の直前で復元/破棄の処理を追加。

**対戦**

* `state` をプレイヤー配列化して、ターンごとに `currentPlayerIndex` を切り替える設計が拡張しやすいです。

---

## キーボード&操作

* **クリック**: スロー（1ターン3投まで）
* **Z**: 一手戻す（Undo）
* **R**: リセット（現在のモードで再開）
* **ドロップダウン**: モード選択
* **ボタン**: 「次のターン」「一手戻す」「リセット」

---

## よくある質問（FAQ）

**Q. クリックしたのに点が入らない？**
A. 301/501で**残りがマイナス**になる投擲は0点扱いです（UI上はMISSのように見えます）。

**Q. スマホでも遊べる？**
A. はい。レスポンシブ対応です。タップでスローできます。

**Q. クリケットなど他ルールは？**
A. 本READMEの「カスタマイズ」を参照。セクションを追加して拡張できます。

**Q. 画像やフォントは外部依存？**
A. 画像は未使用。フォントは Google Fonts を読み込みますが、オフライン時は既定フォントに自動切替されます。

---

## トラブルシュート

* **ボードがぼやける**: HiDPI向けに DPR 調整済みですが、ブラウザ縮小表示だと滲むことがあります。100%表示を推奨。
* **クリック位置がズレる**: OSやブラウザの拡大率によってズレる場合があります。`getBoundingClientRect()` で取得する座標系を変えた場合は注意。
* **フォントが違う**: オフライン時はシステム既定フォントにフォールバックします。CSS で任意に上書きできます。

---

## アクセシビリティ

* `canvas` に **aria-label** と **role="img"** を付与。
* コントラストは暗背景×明テキストで確保。色弱の方向け配色はCSS変数で調整可能。
* キーボード操作（Z/R）を用意。将来的にフォーカスリングやボタンの `aria-pressed` 等の強化を予定。

---

## パフォーマンス

* **1ファイル**・依存ゼロで高速起動。
* DPR（devicePixelRatio）に合わせてキャンバス解像度を最適化。
* 描画は必要時のみ（投擲・ターン操作）に限定。

---

## 開発メモ

* セクターは **18°刻み**、上（12時方向）から時計回り: `SECTORS = [20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5]`
* リングの半径比は、実寸ボード（ダブル外=170mm）を基準化。
* 角度は `Math.atan2(dy,dx)` を 0°=上 になるように調整。

---

## ロードマップ

* [ ] プレイヤー2人対戦（交互ターン）
* [ ] 本格バースト処理（ターン無効化）
* [ ] クリケット等モード追加
* [ ] サウンド/エフェクト（ヒット時のSE）
* [ ] スコアの共有（画像出力・SNS投稿補助）

---

## 貢献ガイドライン

* Issue: バグ/改善提案を歓迎。
* PR: 小さな修正でもOK。UI変更時はスクリーンショットがあると助かります。
* コード規約: Prettier などの整形ルールは未導入（単一HTMLのため）。可読性重視でお願いします。

---

## ライセンス

* **MIT License** を想定。別ライセンスを希望する場合は `LICENSE` を追加して置き換えてください。
  © 2025 shimarin

---

## 変更履歴

* **v1.0.0** — 2025-09-28 (JST): 初版リリース。単一HTML / 練習・301・501 / Undo / 履歴 / モダンUI。

---

## （中学生向け）ミニ解説

* **どんな技術？** 1枚のHTMLの中で、見た目（CSS）と動き（JavaScript）をセットで書いています。
* **どこを投げたか**は、クリックした点の「中心からの距離」と「回る角度」でわかります。
* **点数**は「基本の数字 × 倍率（トリプルなら×3、ダブルなら×2）」で計算します。
* だから、プログラムで**数学（角度と長さ）**を使ってゲームを作れるんです！

---
